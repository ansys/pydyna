See https://deepwiki.com/ansys/pydyna for a description of the codebase
Assume an appropriate virtual environment is activated. If it isn't, just abort.

IGNORE THIS LINE FOR NOW: LS-DYNA keywords are described in detail in the manual, try to find them in manuals/ (note - this is intentionally in .gitignore so we don't distrubute them)

## Agent Hints
Don't try to write to /dev/null, this leads to a prompt that halts execution until the user allows it. I can't find the setting to disable this
in vscode.

## Agent Coding Style Preferences

- Do not use inline comments to explain imports. Instead, use a module-level docstring to indicate the purpose and usage of imported modules. This applies to all agent-generated code, not just codegen modules.
- There is a line limit of 120 characters, and other linting rules. Use precommit run --all-files to run the linters after makin changes.
- **Add comprehensive logging**: Use Python's `logging` module extensively throughout the codebase. Add a logger instance (`logger = logging.getLogger(__name__)`) to each module and use it liberally:
  - Use `logger.debug()` for detailed traceability of execution flow, variable values, and decisions
  - Use `logger.info()` for high-level progress updates and successful operations
  - Use `logger.warning()` for recoverable issues or unexpected conditions
  - Use `logger.error()` for failures with `exc_info=True` to include stack traces
  - Replace any `print()` statements with appropriate logging calls
  - Log function entry/exit for complex operations, parameter values, counts, and decision points

Run `pre-commit run --all-files` after changes

## Agent Guides

Detailed documentation for common tasks and patterns:

- **[agents/linked_keywords.md](agents/linked_keywords.md)**: How to expose relationships between keywords (e.g., DefineTable â†’ DefineCurve) using properties and import handlers.
- **[agents/codegen.md](agents/codegen.md)**: How to work with auto-generated keyword classes and create manual subclasses for customizations.

## Notes on the Keyword Submodule

### Code Generation Handler System

The keyword class generator uses a **handler pipeline** to transform keyword metadata from the JSON schema into Python classes. See `agents/codegen.md` for detailed documentation.

**Key Principles**:
1. **Execution order matters** - handlers are executed in registration order (see `registry.py`)
2. **Reference semantics** - handlers like `card-set` and `table-card-group` use references, not deep copies
3. **In-place mutations** - later handlers modify cards that earlier handlers referenced
4. **Index vs. position** - after reordering, use list positions not the card's `index` property

**Common Pitfall**: Using `copy.deepcopy()` when grouping cards breaks the generation because later handlers' modifications won't appear in the groups.

### Deck Import Handlers

Deck registers import handlers (e.g., `DefineTableProcessor`) and runs them during `Deck.loads()` and include expansion. Handlers see keywords as they are imported and should only assume immediate neighbor context unless explicitly coded otherwise.

For detailed guidance on linking keywords, see [agents/linked_keywords.md](agents/linked_keywords.md).

### Auto-Generated Keywords

The files in `src/ansys/dyna/core/keywords/keyword_classes/auto/` are auto-generated by Jinja templates. If they need to be modified, update the codegen system. If modifications are not straightforward to add to codegen, create a manual subclass instead.

For detailed guidance on working with auto-generated files, see [agents/codegen.md](agents/codegen.md).
