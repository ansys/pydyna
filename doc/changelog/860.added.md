Replace `assert` statements with explicit error handling