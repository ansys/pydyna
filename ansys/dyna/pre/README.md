# pyDyna-pre

The PyDyna-pre provide the ability to create keyword inputdeck by grpc.

## Starting the Server

So far, Python 3.6 is used to start server, make sure this like below:

```
PS C:\pyDyna\examples\pre> C:\python36\python.exe --version
Python 3.6.8
```

### Starting the Server on Windows:

Here is the minimal content in Server folder 
```
Server/
kwserver.py
keywordreader.pyd
kwprocess_pb2.py
kwprocess_pb2_grpc.py
```
Start server by running command:
```shell
PS C:\pyDyna\ansys\dyna\pre\Server> C:\Python36\python.exe .\kwserver.py
kwgrpc Server listening on: localhost:50051
```

### Starting the server on Linux:

Keep these files in the same folder

```
Server/
kwserver.py
keywordreader.so
kwprocess_pb2.py
kwprocess_pb2_grpc.py
```

Start server:

```
:~/pyDyna/ansys/dyna/pre/Server> python kwserver.py
```

## Running pyDyna-pre client

See the examples in the examples folder for some basic example.  More will be added later.

### Structure ALE demo

Go to pyDyna/examples/pre,and run sale_efp.py:

```
PS C:\pyDyna\examples\pre> python .\sale_efp.py
2022-07-05 08:19:42 :  Connected to kwServer...
2022-07-05 08:19:42 :  C:\pyDyna\examples\pre\input\sale\input\efpcase.k uploaded to server...
2022-07-05 08:19:43 :  Setup Analysis...
2022-07-05 08:19:43 :  Material air Created...
2022-07-05 08:19:43 :  Material air Created...
2022-07-05 08:19:43 :  Material HE Created...
2022-07-05 08:19:43 :  Material HE Created...
2022-07-05 08:19:43 :  Material liner Created...
2022-07-05 08:19:43 :  Material liner Created...
2022-07-05 08:19:43 :  Material vacuum Created...
2022-07-05 08:19:43 :  Material vacuum Created...
2022-07-05 08:19:43 :  ALE Structured mesh 1 Created...
2022-07-05 08:19:43 :  Material air filled in Mesh 1...
2022-07-05 08:19:43 :  Material HE filled in Mesh 1...
2022-07-05 08:19:43 :  Material liner filled in Mesh 1...
2022-07-05 08:19:43 :  Location of high explosive detonation Defined...
2022-07-05 08:19:43 :  Output Setting...
2022-07-05 08:19:43 :  efpcase.k is outputed...
```

At the same time, corresponding information will be printed in the server side.

```
Load model: C:\pyDyna\ansys\dyna\pre\Server\input\efpcase.k
*DATABASE_SALE Created...
Termination Created...
DB Binary Created...
*CONTROL_ALE Created...
*EOS_LINEAR_POLYNOMIAL Created...
*MAT_NULL Created...
*ALE_STRUCTURED_MULTI-MATERIAL_GROUP Created...
*MAT_HIGH_EXPLOSIVE_BURN Created...
*EOS_JWL Created...
*ALE_STRUCTURED_MULTI-MATERIAL_GROUP Created...
*MAT_JOHNSON_COOK Created...
*EOS_GRUNEISEN Created...
*ALE_STRUCTURED_MULTI-MATERIAL_GROUP Created...
*MAT_VACUUM Created...
*ALE_STRUCTURED_MULTI-MATERIAL_GROUP Created...
*ALE_STRUCTURED_MESH_CONTROL_POINTS Created...
*ALE_STRUCTURED_MESH_CONTROL_POINTS Created...
*ALE_STRUCTURED_MESH_CONTROL_POINTS Created...
*ALE_STRUCTURED_MESH Created...
*ALE_STRUCTURED_MESH_VOLUME_FILLING Created...
*ALE_STRUCTURED_MESH_VOLUME_FILLING Created...
*ALE_STRUCTURED_MESH_VOLUME_FILLING Created...
*INITIAL_DETONATION Created...
Database MATSUMCreated...
Database GLSTATCreated...
Saved Successfully!
```

After running this file,the result file will be save in pyDyna/ansys/dyna/pre/Server/output

```
PS C:\pyDyna\ansys\dyna\pre\Server> cd .\output\
PS C:\pyDyna\ansys\dyna\pre\Server\output> ls


    目录: C:\pyDyna\ansys\dyna\pre\Server\output


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----          2022/7/5      8:19        2436058 efpcase.k
```

Submit the result file, efpcase.k, to LS-Dyna for simulation results.